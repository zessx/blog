---
layout: post
title:  "Alphabet JS obfuscated"
date:   2021-08-18
tags:
- js
description: >
  Petite excursion amusante dans le JS pour jouer avec les lettres
---

## L√† o√π tout a commenc√©

Le JavaScript est plein de ces petites surprises sur lesquelles on tombe tous un jour et qui nous font perdre pas mal de temps avant que l'on ne les comprenne. Il y a plusieurs mois, une s√©ance de peer review m'a amen√© √† d√©couvrir un bug, avec √† son origine un de ces petites surprises :

```js
0.1 + 0.2
// 0.30000000000000004
```

Tout en rageant, discutant et r√¢lant l√†-dessus, je retombe sur le g√©nial et connu repository de [WTFJS](https://github.com/denysdovhan/wtfjs). N'h√©sitez pas √† aller y faire un tour, c'est instructif et‚Ä¶ inspirant‚Ä¶

C'est justement en parcourant cette liste que je tombe sur la perle suivante :

```js
![]+[]
// "false"
```

Quelques notes avant d'aller plus loin :
- L'op√©rande de gauche `![]` est interpr√™t√© comme `false` (car visiblement `!Array() === false`)
- L'op√©rande de droite `[]` est un simple array
- Utiliser l'op√©rateur `+` sur un bool√©en provoque l'appel de `toString()` sur l'op√©rande de droite

On a donc pour r√©sumer et expliquer le r√©sultat ces √©quivalences :

```
![]+[]
![] + []
!Array() + [].toString()
false + ""
"false"
```

Il y a une certaine logique derri√®re (tr√®s discutable) mais ce qui me frappe sur le moment, c'est qu'√† partir de symboles uniquement (`!+[]`) on est capable de sortir une cha√Æne de caract√®res alphab√©tiques‚Ä¶

## De A √† Z

Une id√©e germe alors : est-on capable de faire un alphabet complet avec un charset restreint √† quelques symboles ? Ce serait un excellent moyen d'obfuscate du JavaScript.

**Spoiler : Internet.** (aka. oui et je ne suis clairement pas le premier √† y penser)

Pour commencer, nous aurons besoin de g√©n√©rer deux choses essentielles :
- Des cha√Ænes de caract√®res (pour extraire notre alphabet)
- Des nombres (pour s√©cifier les indices)

L'id√©e √©tant de g√©n√©rer ce genre de code, sans les caract√®res alphanum√©riques :

```js
"false"[1]
// a
```

## Les nombres

Avant m√™me de r√©fl√©chir au cha√Ænes de caract√®res disponibles, nous devons √™tre capables de g√©n√©rer des nombres. Il se trouve qu'on peut facilement caster un bool√©en en entier √† l'aide de l'op√©rateur unaire `+` :

```js
+false
// 0
+true
// 1
```

En reprenant le premier op√©rande de notre exemple (qui valait `false` je le rappelle) on peut donc avoir :

```js
+![]
// 0
+!![]
// 1
```

√Ä partir de l√†, nous allons pouvoir faire deux op√©rations selon les besoins : l'addition ou la concat√©nation :

```js
+!![]+!![]
// 2
+!![]+[+!![]]
// 11
```

Plus de limites, nous pouvons d√©sormais cr√©er n'importe quel nombre gr√¢ce √† ces deux techniques !

## Les bool√©ens

√Ä pr√©sent que nous sommes capables d'extraire des caract√®res d'une cha√Ænes, voyons ce que JavaScript nous propose. Les deux premiers exemples sont √©videmment les valeurs bool√©ennes vu pr√©c√©demment :

```js
![]
// false
!![]
// true
```

En englobant ces valeurs stringifi√©e (√† l'aide de `+[]`), nous pouvons ainsi r√©cup√©rer le eni√®me charact√®re de chaque cha√Æne :

```js
(![]+[])[+!![]]
// "a"
(!![]+[])[!![]+!![]+!![]]
(![]+[])[!![]+!![]+!![]+!![]]
// "e"
(![]+[])[+[]]
// "f"
(![]+[])[!![]+!![]]
// "l"
(!![]+[])[+!![]]
// "r"
(![]+[])[!![]+!![]+!![]]
// "s"
(!![]+[])[+[]]
// "t"
(!![]+[])[!![]+!![]]
// "u"
```

Pour le `e` nous pr√©f√©rerons l'extraire de la cha√Æne `true` car son indice y est plus petit (3) que dans `false` (4), cel√† demandera donc un peu moins de symboles.

> Et nous voil√† √† pr√©sent avec un petit d√©but d'alphabet :
> `a...ef.....l.....rstu.....` (27%)

## D'autres cha√Ænes

Avec ce que l'on connait, on peut d√©j√† facilement trouver deux cha√Ænes suppl√©mentaires. La premi√®re est `undefined`, que JS nous renverra si l'on essaie d'acc√©der √† un indice non d√©fini sur un tableau et qui nous offrirait les lettres `d`, `i` et `n`), or nous savons d√©j√† cr√©er des tableau et des nombres :

```js
[][0]
// undefined
[][+[]]
// undefined
([][+[]]+[])[!![]+!![]]
// "d"
([][+[]]+[])[!![]+!![]+!![]+!![]+!![]]
// "i"
([][+[]]+[])[+!![]]
// "n"
```

De la m√™me mani√®re que nous avons utilis√© `toString()` sur un tableau, on peut le faire sur un objet et r√©cup√©rer une nouvelle cha√Æne avec les lettres `b`, `c`, `j` et `o`:

```js
({}).toString()
// "[object Object]"
[]+{}
// "[object Object]"
([]+{})[!![]+!![]]
// "b"
([]+{})[!![]+!![]+!![]+!![]+!![]]
// "c"
([]+{})[!![]+!![]+!![]]
// "j"
([]+{})[+!![]]
// "o"
```

> √âtat de l'alphabet :
> `abcdef..ij.l.no..rstu.....` (54%)

## Les constructeurs

*La suite de cet article est bas√© sur le travail de [Mr. Papercut](https://mrpapercut.com/blog/2016-09-06-non-alphanum-obfuscator), sans lequel je n'aurais pas pu avancer plus loin, fautes de connaissances approfondies sur le JavaScript.*

La propri√©t√© qui va nous int√©resser pour la suite est le constructeur. Cette propri√©t√© est disponible sur toutes les variables en JS, et renvoie les r√©sultats suivants :

```js
(1).constructor
// ∆í Number() { [native code] }
"".constructor
// ∆í String() { [native code] }
/a/.constructor
// ∆í RegExp() { [native code] }
[].constructor
// ∆í Array() { [native code] }
```

On peut l√† aussi appeler la propri√©t√© avec la forme `(1)["constructor"]`, et il se trouve que nous avons d√©j√† toutes les lettres n√©cessaire !

```js
([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]
// "constructor"
```

Et ainsi nous pouvons r√©cup√©rer les lettres `g`, `m`, `p`, `v`, `x` et `y`

```js
/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]
// ∆í RegExp() { [native code] }
[]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]
// "function RegExp() { [native code] }"
([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]
// "g"
([]+(+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]
// "m"
([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]]+[+!![]+!![]+!![]+!![]])]
// "p"
([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]+!![]]+[+!![]+!![]+!![]+!![]+!![]])]
// "v"
([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]]+[+!![]+!![]+!![]])]
// "x"
([]+[][([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]+!![]+!![]]]
// "y"
```

> √âtat de l'alphabet :
> `abcdefg.ij.lmnop.rstuv.xy.` (81%)

## Les bases

// H K Q W Z

Pour les 5 lettres restantes, n'ayant pas trouv√© de moyen de les r√©cup√©rer via des cha√Ænes, il va falloir ruser avec les bases. La base 36 utilise 36 caract√®res (les 10 chiffres plus l'alphabet complet), codant les nombres suivants ainsi :
- 0 : 0
- 1 : 1
- 9 : 9
- 10 : a
- 35 : z

Le principe serait de transformer un nombre en sa repr√©sentation en base 36 :

```js
(10).toString(36)
// "a"
(35).toString(36)
// "z"
(35)["toString"](36)
// "z"
```

Pour ce faire, nous aurons besoin des nombres et des lettres pour faire le mot `toString`. Nous avons d√©j√† toutes les lettres sauf une : le `S` majuscule, mais qui pourra √™tre r√©cup√©r√©e √† partir du constructeur d'une `String` :

```js
[]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]
// "function String() { [native code] }"
([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]
// S
(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]
// toString
+(!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]])
// 35
(+(+!![]+[!![]+!![]+!![]+!![]+!![]+!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
// "h"
(+(!![]+!![]+[+[]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
// "k"
(+(!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
// "q"
(+(!![]+!![]+!![]+[!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
// "w"
(+(!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
// "z"
```

> √âtat de l'alphabet :
> `abcdefghijklmnopqrstuvwxyz` (100%) üéâ

## Optimisations

Bon, c'est bien tout √ßa mais c'est tr√®s verbeux, avec plus de 5000 symboles pour repr√©senter tout l'alphabet ! Quelques optimisations sont possibles ici et l√†.

La premi√®re concerne les lettre `h`, `k` et `w`, qui peuvent aussi s'√©crire dans d'autres bases que la base 36. Leurs indices respectifs dans cette base sont 17, 20 et 32 ; il faut prendre en compte que le nombre 36 et ces indices sont assez long √† √©crire. En jouant avec les diff√©rentes bases, les mani√®res les plus courtes d'√©crire ces trois lettres sont les suivantes :

```js
(101).toString(21)[1]
(+(+!![]+[+[]]+[+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+[+!![]])[+!![]]
// "h"
(20).toString(21)
(+(!![]+!![]+[+[]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+[+!![]])
// "k"
(32).toString(33)
(+(!![]+!![]+!![]+[!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]])
// "w"
```

On gagne ainsi respectivement 45, 29 et 29 symboles pour √©crire l'alphabet.

Pour la lettre `i` (bas√©e sur `undefined`), le trick est qu'il est beaucoup plus rapide d'√©crire 11 que 6 (pour gagner 11 symboles) :

```js
"undefined"[6]
"falseundefined"[11]
// n
!![]+!![]+!![]+!![]+!![]
// 6
+!![]+[+[]]
// 11
[![]]+[][[]]
// "falseundefined"
([![]]+[][[]])[+!![]+[+[]]]
// n
```

Pour la lettre `y`, plut√¥t que de passer par le constructeur `Array` on peut jouer avec `Infinity` pour gagner 177 symboles. L√† aussi on va aller modifier la cha√Æne pour chercher l'indice 10 (plus rapide √† √©crire que l'indice 7)
```js
1e1000
// Infinity
+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]]
// "1e1000"
+(+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]])+[]
// "Infinity"
(+(+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]])+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]
// "y"
+[![]]+[+(+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]])]
// "NaNInfinity
(+[![]]+[+(+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]])])[+!![]+[+[]]]
// "y"
```

Avec ces optimisation, on r√©duit la taille de l'alphabet d'environ 5%. Il doit probablement en exister bien d'autres, toutes aussi int√©ressantes √† d√©couvrir les unes que les autres, n'h√©sitez pas √† m'en faire part si vous en d√©couvrez !

## Pour finir

Voici un r√©capitulatif de l'ensemble de l'alphabet, avec leurs optimisations et l'espace en bonus pour pouvoir √©crire ce que vous voulez :

```js
/*   */ ([]+{})[!![]+!![]+!![]+!![]+!![]+!![]+!![]]
/* a */ (![]+[])[+!![]]
/* b */ ([]+{})[!![]+!![]]
/* c */ ([]+{})[!![]+!![]+!![]+!![]+!![]]
/* d */ ([][+[]]+[])[!![]+!![]]
/* e */ ([][+[]]+[])[!![]+!![]+!![]]
/* f */ (![]+[])[+[]]
/* g */ ([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]
/* h */ (+(+!![]+[+[]]+[+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+[+!![]])[+!![]]
/* i */ ([![]]+[][[]])[+!![]+[+[]]]
/* j */ ([]+{})[!![]+!![]+!![]]
/* k */ (+(!![]+!![]+[+[]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+[+!![]])
/* l */ (![]+[])[!![]+!![]]
/* m */ ([]+(+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]
/* n */ ([][+[]]+[])[+!![]]
/* o */ ([]+{})[+!![]]
/* p */ ([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]]+[+!![]+!![]+!![]+!![]])]
/* q */ (+(!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
/* r */ (!![]+[])[+!![]]
/* s */ (![]+[])[!![]+!![]+!![]]
/* t */ (!![]+[])[+[]]
/* u */ (!![]+[])[!![]+!![]]
/* v */ ([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]+!![]]+[+!![]+!![]+!![]+!![]+!![]])]
/* w */ (+(!![]+!![]+!![]+[!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]])
/* x */ ([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+([+!![]]+[+!![]+!![]+!![]])]
/* y */ (+[![]]+[+(+!![]+(!![]+[])[!![]+!![]+!![]]+[+!![]]+[+[]]+[+[]]+[+[]])])[+!![]+[+[]]]
/* z */ (+(!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]+!![]+!![]+!![]])
```

Avec l'exemple obligatoire ci-dessous :

```js
(+(+!![]+[+[]]+[+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+[+!![]])[+!![]]+([][+[]]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(![]+[])[!![]+!![]]+([]+{})[+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(+(!![]+!![]+!![]+[!![]+!![]]))[(!![]+[])[+[]]+([]+{})[+!![]]+([]+([]+[])[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([![]]+[][[]])[+!![]+[+[]]]+([][+[]]+[])[+!![]]+([]+/!/[([]+{})[!![]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][+[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+([]+{})[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]])[+!![]+[+!![]]]](!![]+!![]+!![]+[!![]+!![]+!![]])+([]+{})[+!![]]+(!![]+[])[+!![]]+(![]+[])[!![]+!![]]+([][+[]]+[])[!![]+!![]]
// hello world
```

## Liens :

[WTFJS](https://github.com/denysdovhan/wtfjs)
[Un article similaire de Mr. Papercut](https://mrpapercut.com/blog/2016-09-06-non-alphanum-obfuscator)